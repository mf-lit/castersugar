{% extends "base.html" %}

{% block title %}Radio - Castersugar{% endblock %}

{% block content %}
<div class="radio-page">
    <h2>Radio</h2>

    <div id="error-message" class="error" style="display: none;"></div>

    <!-- Device selector and controls -->
    <div class="radio-controls">
        <div class="control-group">
            <label for="device-select">Device:</label>
            <select id="device-select" class="device-select">
                <option value="">Select a device...</option>
            </select>
        </div>

        <div class="playback-buttons">
            <button id="play-btn" class="btn btn-play" disabled>
                <span>‚ñ∂</span> Play
            </button>
            <button id="stop-btn" class="btn btn-stop" disabled>
                <span>‚èπ</span> Stop
            </button>
            <div class="volume-control">
                <button class="volume-icon" id="volume-icon" title="Volume">üîä</button>
                <div class="volume-slider-container">
                    <input type="range" id="volume-slider" class="volume-slider" min="0" max="100" value="50">
                </div>
            </div>
        </div>
    </div>

    <!-- Now Playing -->
    <div id="now-playing" class="now-playing" style="display: none;">
        <div class="now-playing-station-info">
            <span class="now-playing-label">Now Playing:</span>
            <span class="now-playing-station" id="now-playing-station"></span>
        </div>
        <div class="now-playing-track-info" id="now-playing-track-info" style="display: none;"></div>
    </div>

    <!-- Stations list -->
    <div class="stations-section">
        <h3>Stations</h3>

        <div id="loading-stations" class="loading" style="display: none;">
            <p>Loading stations...</p>
        </div>

        <div id="stations-list" class="stations-list">
            <!-- Stations will be loaded here -->
        </div>

        <button id="add-station-btn" class="btn btn-primary add-station-btn">
            <span>+</span> Add Station
        </button>
    </div>
</div>

<!-- Add/Edit Station Modal -->
<div id="station-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modal-title">Add Station</h3>
            <button class="modal-close" id="close-modal">&times;</button>
        </div>
        <div class="modal-body">
            <form id="station-form">
                <input type="hidden" id="station-id" value="">

                <div class="form-group">
                    <label for="station-name">Station Name*</label>
                    <input type="text" id="station-name" class="form-input" required placeholder="e.g. BBC Radio 1">
                </div>

                <div class="form-group">
                    <label for="station-url">Playback URL*</label>
                    <input type="url" id="station-url" class="form-input" required placeholder="https://...">
                    <small>The streaming URL for the radio station</small>
                </div>

                <div class="form-group">
                    <label for="station-icon">Icon URL</label>
                    <div class="input-with-button">
                        <input type="url" id="station-icon" class="form-input" placeholder="https://...">
                        <button type="button" id="refresh-icon-btn" class="btn-icon-refresh" title="Refresh icon from URL">
                            üîÑ
                        </button>
                    </div>
                    <small>URL to an image for the station icon</small>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-btn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Station</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal-backdrop" id="modal-backdrop" style="display: none;"></div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='radio.js') }}"></script>
{% endblock %}
